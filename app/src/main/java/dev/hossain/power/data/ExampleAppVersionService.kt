package dev.hossain.power.data

import android.content.Context
import dev.hossain.power.di.ApplicationContext
import dev.zacsweers.metro.AppScope
import dev.zacsweers.metro.Inject
import dev.zacsweers.metro.SingleIn

/**
 * Example service class that demonstrates Metro constructor injection with scoping.
 *
 * The [@Inject][Inject] annotation marks this class for constructor injection, and
 * [@SingleIn][SingleIn] ensures only one instance exists per [AppScope].
 *
 * This service retrieves the application version at initialization time and caches it.
 *
 * See https://zacsweers.github.io/metro/latest/injection-types/#constructor-injection
 * See https://zacsweers.github.io/metro/latest/scopes/
 */
@SingleIn(AppScope::class)
@Inject
class ExampleAppVersionService
    constructor(
        @ApplicationContext context: Context,
    ) {
        private val versionName: String = context.packageManager.getPackageInfo(context.packageName, 0).versionName ?: "Unknown"

        fun getApplicationVersion(): String = versionName
    }
